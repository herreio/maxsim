image: rocker/verse:3.6.2

pages:
  stage: deploy
  before_script:
    - apt-get update
    - apt-get install -y tree
  script:
    - mkdir public
    - r -e 'devtools::build()'
    - mv ../maxsim_0.0.1.tar.gz public/
    - r -e 'devtools::build_manual()'
    - mv ../maxsim_0.0.1.pdf public/
    - cd public/
    - tree . > ../tree.txt
    - echo "<html><body><pre>" > index.html
    - cat ../tree.txt >> index.html
    - echo "</pre></body></html>" >> index.html
    - rm ../tree.txt
  artifacts:
    paths:
      - public
  only:
    - master
